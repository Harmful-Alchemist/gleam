---
source: compiler-core/src/wasm.rs
expression: wat
---
(module

(type $heap_type (sub (struct (field $tag i64))))
(rec
  (type $list (sub $heap_type (struct (field $tag i64))))
  (type $cons (sub final $list (struct (field $tag i64) (field $value (ref eq)) (field $prev (ref $list)))))
  (type $empty (sub final $list (struct (field $tag i64))))
)
(type $Cat_struct (sub $heap_type (struct (field $tag i64) (field $name (ref i31)) (field $cuteness (ref i31)))))
(type $Kitten_struct (sub $heap_type (struct (field $tag i64) (field $name (ref i31)) (field $age (ref i31)) (field $cuteness (ref i31)))))
(func $Cat (param $name (ref i31)) (param $cuteness (ref i31)) (result (ref $Cat_struct))
    (struct.new $Cat_struct (i64.const -615244078225387894) (local.get $name) (local.get $cuteness)))
(func $Kitten (param $name (ref i31)) (param $age (ref i31)) (param $cuteness (ref i31)) (result (ref $Kitten_struct))
    (struct.new $Kitten_struct (i64.const -1857749477015907541) (local.get $name) (local.get $age) (local.get $cuteness)))
(func $add_cat (param $cat (ref $Cat_struct)) (result (ref i31))
    (i32.add (local.get $cat) (struct.get $Cat_struct $cuteness) (i31.get_s) (local.get $cat) (struct.get $Cat_struct $name) (i31.get_s))
    (ref.i31))
(func $grow (param $kitten (ref $Kitten_struct)) (result (ref $Cat_struct))
    (call $Cat (local.get $kitten) (struct.get $Kitten_struct $name) (i32.sub (local.get $kitten) (struct.get $Kitten_struct $cuteness) (i31.get_s) (i32.const 1) (ref.i31) (i31.get_s)) (ref.i31)))
(func $add (export "add") (param $x (ref i31)) (param $y (ref i31)) (result (ref i31))
    (local $kitten (ref $Kitten_struct))
    (local $cat (ref $Cat_struct))
    (call $Kitten (local.get $x) (i32.const 12) (ref.i31) (local.get $y))
    (local.set $kitten)
    (call $grow (local.get $kitten))
    (local.set $cat)
    (call $add_cat (local.get $cat)))
(@producers (language "Gleam" "1.0.0"))
)
